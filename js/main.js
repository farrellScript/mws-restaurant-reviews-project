let restaurants,neighborhoods,cuisines;var newMap,markers=[];document.addEventListener("DOMContentLoaded",e=>{initMap(),fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const n=document.createElement("option");n.innerHTML=e,n.value=e,t.append(n)})}),initMap=(()=>{self.newMap=L.map("map",{center:[40.722216,-73.987501],zoom:12,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiZmFycmVsbHNjcmlwdCIsImEiOiJjamJiaTl3dHMxOGxsMzJwZTlmYnN4ZHN5In0.6Ey50el0atwjDygO_cO0sA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,s=t.selectedIndex,a=e[n].value,r=t[s].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(a,r,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap()}),createRestaurantHTML=(e=>{const t=document.createElement("li"),n=document.createElement("img");n.className="restaurant-img",n.alt=DBHelper.imageTextForRestaurant(e),n.srcset=DBHelper.imageSrcSetForRestaurant(e),n.src=DBHelper.imageUrlForRestaurant(e),t.append(n);const s=document.createElement("h2");s.innerHTML=e.name,t.append(s);const a=document.createElement("p");a.innerHTML=e.neighborhood,t.append(a);const r=document.createElement("p");r.innerHTML=e.address,t.append(r);const o=document.createElement("a");return o.innerHTML=DBHelper.urlTextForRestaurant(e),o.href=DBHelper.urlForRestaurant(e),t.append(o),t}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.newMap);t.on("click",function(){window.location.href=t.options.url})})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJuZXdNYXAiLCJtYXJrZXJzIiwiZmV0Y2hDdWlzaW5lcyIsImluaXRNYXAiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJjb25zb2xlIiwiZXJyb3IiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwibmVpZ2hib3Job29kIiwic2VsZWN0Iiwib3B0aW9uIiwiZG9jdW1lbnQiLCJpbm5lckhUTUwiLCJhcHBlbmQiLCJ2YWx1ZSIsIkRCSGVscGVyIiwiZmlsbEN1aXNpbmVzSFRNTCIsImdldEVsZW1lbnRCeUlkIiwiY3Vpc2luZSIsImNlbnRlciIsIkwiLCJtYXAiLCJ6b29tIiwic2Nyb2xsV2hlZWxab29tIiwibWFwYm94VG9rZW4iLCJtYXhab29tIiwiYXR0cmlidXRpb24iLCJpZCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiYWRkVG8iLCJjU2VsZWN0IiwibkluZGV4IiwiblNlbGVjdCIsInNlbGVjdGVkSW5kZXgiLCJjSW5kZXgiLCJmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QiLCJyZXNldFJlc3RhdXJhbnRzIiwiZmlsbFJlc3RhdXJhbnRzSFRNTCIsImZvckVhY2giLCJtIiwic2V0TWFwIiwidWwiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsInJlc3RhdXJhbnQiLCJhZGRNYXJrZXJzVG9NYXAiLCJpbWFnZSIsImNsYXNzTmFtZSIsImNyZWF0ZUVsZW1lbnQiLCJzcmNzZXQiLCJpbWFnZVNyY1NldEZvclJlc3RhdXJhbnQiLCJzcmMiLCJsaSIsImltYWdlVGV4dEZvclJlc3RhdXJhbnQiLCJuYW1lIiwiYWRkcmVzcyIsIm1vcmUiLCJ1cmxUZXh0Rm9yUmVzdGF1cmFudCIsImhyZWYiLCJ1cmxGb3JSZXN0YXVyYW50IiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsIndpbmRvdyIsImxvY2F0aW9uIiwi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S0YsT0FQRVEsRUFBSzNDLFVBQVlHLFNBQVN5QyxxQkFBcUJiLEdBSS9DWSxFQUFBRSxLQUFBMUMsU0FBQTJDLGlCQUFBZixHQTNCRlEsRUFBQXRDLE9BQUEwQyxHQThCQUosSUFNSVAsZ0JBQU1lLEVBQVM1QyxFQUFTNkMsS0FBQUEsZUFDeEJELEVBQVVyQixRQUFWSyxJQUVFa0IsTUFBQUEsRUFBT0MsU0FBUEYsdUJBQUFqQixFQUFBckMsS0FBQVAsUUFDRDRELEVBQUFJLEdBQUEsUUFOSCxXQURGRixPQUFBQyxTQUFBTCxLQUFBRSxFQUFBSyxRQUFBQyIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnRzLFxyXG4gIG5laWdoYm9yaG9vZHMsXHJcbiAgY3Vpc2luZXNcclxudmFyIG5ld01hcFxyXG52YXIgbWFya2VycyA9IFtdXHJcblxyXG4vLyAvKipcclxuLy8gICogQ2hlY2sgdG8gc2VlIGlmIHNlcnZpY2Ugd29ya2VyIGlzIHN1cHBvcnRlZCBieSB0aGUgYnJvd3NlciBcclxuLy8gICovXHJcbi8vIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSB7XHJcbiAgXHJcbi8vICAgLyogaWYgaXQgaXMsIHJlZ2lzdGVyIHRoZSBzZXJ2aWNlIHdvcmtlciAqL1xyXG4vLyAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCcvc3cuanMnKS50aGVuKGZ1bmN0aW9uKHJlcyl7XHJcblxyXG4vLyAgICAgLy8gQWxyZWFkeSBvbiB0aGUgbGF0ZXN0IHZlcnNpb24sIGJhaWxcclxuLy8gICAgIGlmKCFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5jb250cm9sbGVyKXtcclxuLy8gICAgICAgcmV0dXJuO1xyXG4vLyAgICAgfVxyXG4vLyAgICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZXJlJ3MgYSB3YWl0aW5nIHNlcnZpY2Ugd29ya2VyXHJcbi8vICAgICBpZiAocmVzLndhaXRpbmcpe1xyXG4vLyAgICAgICBfdXBkYXRlUmVhZHkoKTtcclxuLy8gICAgICAgcmV0dXJuIFxyXG4vLyAgICAgfVxyXG5cclxuLy8gICAgIGlmIChyZXMuaW5zdGFsbGluZykge1xyXG4vLyAgICAgICBfdHJhY2tJbnN0YWxsaW5nKHJlcy5pbnN0YWxsaW5nKTtcclxuLy8gICAgICAgcmV0dXJuO1xyXG4vLyAgICAgfVxyXG4gICAgXHJcbi8vICAgICByZXMuYWRkRXZlbnRMaXN0ZW5lcigndXBkYXRlZm91bmQnLCBmdW5jdGlvbigpIHtcclxuLy8gICAgICAgX3RyYWNrSW5zdGFsbGluZyhyZXMuaW5zdGFsbGluZyk7XHJcbi8vICAgICB9KTtcclxuICAgIFxyXG4vLyAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycm9yKXtcclxuLy8gICAgIGNvbnNvbGUubG9nKCdlcnJvciByZWdpc3RlcmluZyBzZXJ2aWNlIHdvcmtlcjogJyxlcnJvcilcclxuLy8gICB9KTtcclxuICBcclxuLy8gICBmdW5jdGlvbiBfdHJhY2tJbnN0YWxsaW5nKHdvcmtlcil7XHJcbi8vICAgICB3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignc3RhdGVjaGFuZ2UnLGZ1bmN0aW9uKCl7XHJcbi8vICAgICAgIGlmICh3b3JrZXIuc3RhdGUgPT0gJ2luc3RhbGxlZCcpe1xyXG4vLyAgICAgICAgIF91cGRhdGVSZWFkeSh3b3JrZXIpO1xyXG4vLyAgICAgICB9XHJcbi8vICAgICB9KVxyXG4vLyAgIH1cclxuXHJcbi8vICAgdmFyIGZvY3VzZWRFbGVtZW50O1xyXG4vLyAgIC8qKlxyXG4vLyAgICAqIE5vdGlmaWVzIHRoZSB1c2VyIHRoYXQgYW4gdXBkYXRlZCBTVyBpcyBhdmFpbGFibGVcclxuLy8gICAgKi9cclxuLy8gICBmdW5jdGlvbiBfdXBkYXRlUmVhZHkod29ya2VyKXtcclxuLy8gICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyBvbiB0aGUgdXBkYXRlIGJ1dHRvbiwgdXBkYXRlIHRoZSBzZXJ2aWNlIHdvcmtlclxyXG4vLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwZGF0ZS12ZXJzaW9uJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLGZ1bmN0aW9uKCl7XHJcbi8vICAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7YWN0aW9uOidza2lwV2FpdGluZyd9KTtcclxuLy8gICAgIH0pO1xyXG4vLyAgICAgLy8gSWYgdGhlIHVzZXIgY2xpY2tzIHRoZSBkaXNtaXNzIGJ1dHRvbiwgaGlkZSB0aGUgdG9hc3RcclxuLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaXNtaXNzLXZlcnNpb24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsZnVuY3Rpb24oKXtcclxuLy8gICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbi8vICAgICAgIGZvY3VzZWRFbGVtZW50LmZvY3VzKClcclxuLy8gICAgIH0pO1xyXG4vLyAgICAgLy8gSWYgdGhlIHRvYXN0IGlzIGRpc3BsYXlpbmcsIGxpc3RlbiBmb3Iga2V5Ym9hcmQgZXZlbnRzXHJcbi8vICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9hc3QnKS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJyxmdW5jdGlvbihlKXtcclxuLy8gICAgICAgLy9DaGVjayBmb3IgVGFiIGtleSBwcmVzc1xyXG4vLyAgICAgICBpZihlLmtleUNvZGUgPT09IDkpe1xyXG4gICAgICAgIFxyXG4vLyAgICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7XHJcbi8vICAgICAgICAgICAvL1ByZXNzZWQgU2hpZnQgVGFiXHJcbi8vICAgICAgICAgICBpZihkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBmaXJzdFRhYlN0b3ApIHtcclxuLy8gICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4vLyAgICAgICAgICAgICBsYXN0VGFiU3RvcC5mb2N1cygpO1xyXG4vLyAgICAgICAgICAgICBjb25zb2xlLmxvZygnY3VycmVudCBmb2N1cyA6Jyxkb2N1bWVudC5hY3RpdmVFbGVtZW50KVxyXG4vLyAgICAgICAgICAgfVxyXG4vLyAgICAgICAgIH1lbHNle1xyXG4vLyAgICAgICAgICAgLy9QcmVzc2VkIFRhYlxyXG4vLyAgICAgICAgICAgaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gbGFzdFRhYlN0b3ApIHtcclxuLy8gICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4vLyAgICAgICAgICAgICBmaXJzdFRhYlN0b3AuZm9jdXMoKTtcclxuLy8gICAgICAgICAgIH1cclxuLy8gICAgICAgICB9XHJcbi8vICAgICAgIH1cclxuLy8gICAgICAgLy8gRXNjYXBlIEtleVxyXG4vLyAgICAgICBpZiAoZS5rZXlDb2RlID09PSAyNyl7XHJcbi8vICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbi8vICAgICAgICAgZm9jdXNlZEVsZW1lbnQuZm9jdXMoKVxyXG4vLyAgICAgICB9IFxyXG4vLyAgICAgfSk7XHJcblxyXG4vLyAgICAgLy8gUmVtZW1iZXIgd2hhdCB0aGUgbGFzdCBlbGVtZW50IHRoYXQgd2FzIGZvY3VzZWQgd2FzLCBhbmQgbWFrZSBpdCBmb2N1c2FibGUgc28gd2UgY2FuIHJldHVybiB0byBpdFxyXG4vLyAgICAgZm9jdXNlZEVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xyXG4vLyAgICAgZm9jdXNlZEVsZW1lbnQudGFiaW5kZXggPSAxO1xyXG4gICBcclxuLy8gICAgIC8vIFdoZW4gdGhlIHRvYXN0IGlzIHZpc2libGUsIHRoaXMgaXMgd2hhdCB3ZSdsbCB1c2UgdG8gdGVtcG9yYXJpbHkgdHJhcCBmb2N1c1xyXG4vLyAgICAgdmFyIGZvY3VzYWJsZUVsZW1lbnRzU3RyaW5nID0gJyN0b2FzdCBwLCAjdXBkYXRlLXZlcnNpb24sICNkaXNtaXNzLXZlcnNpb24nO1xyXG4vLyAgICAgdmFyIGZvY3VzYWJsZUVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChmb2N1c2FibGVFbGVtZW50c1N0cmluZyk7XHJcbi8vICAgICBmb2N1c2FibGVFbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZvY3VzYWJsZUVsZW1lbnRzKTtcclxuICAgIFxyXG4vLyAgICAgdmFyIGZpcnN0VGFiU3RvcCA9IGZvY3VzYWJsZUVsZW1lbnRzWzBdO1xyXG4vLyAgICAgdmFyIGxhc3RUYWJTdG9wID0gZm9jdXNhYmxlRWxlbWVudHNbZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoIC0xXTtcclxuXHJcbi8vICAgICAvLyBPayB0aW1lIHRvIHNob3cgdGhlIHRvYXN0IGFuZCBmb2N1cyBvbiBpdFxyXG4vLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbi8vICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjdG9hc3QgcCcpLmZvY3VzKCk7XHJcblxyXG4vLyAgIH1cclxuICBcclxuXHJcbi8vICAgLyoqXHJcbi8vICAgICogTGlzdGVucyBmb3IgYSBjaGFuZ2UgaW4gdGhlIFNXLCByZWxvYWRzIHRoZSBwYWdlIGFzIGEgcmVzdWx0XHJcbi8vICAgICovXHJcbi8vICAgdmFyIHJlZnJlc2hpbmc7XHJcbi8vICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignY29udHJvbGxlcmNoYW5nZScsIGZ1bmN0aW9uKCkge1xyXG4vLyAgICAgY29uc29sZS5sb2coJ2NvbnRyb2xsZXIgY2hhbmdlJylcclxuLy8gICAgIGlmIChyZWZyZXNoaW5nKSByZXR1cm47XHJcbi8vICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XHJcbi8vICAgICByZWZyZXNoaW5nID0gdHJ1ZTtcclxuLy8gICB9KTtcclxuLy8gfVxyXG5cclxuXHJcblxyXG4vKipcclxuICogRmV0Y2ggbmVpZ2hib3Job29kcyBhbmQgY3Vpc2luZXMgYXMgc29vbiBhcyB0aGUgcGFnZSBpcyBsb2FkZWQuXHJcbiAqL1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgaW5pdE1hcCgpO1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gIERCSGVscGVyLmZldGNoTmVpZ2hib3Job29kcygoZXJyb3IsIG5laWdoYm9yaG9vZHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3JcclxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZWxmLm5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzO1xyXG4gICAgICBmaWxsTmVpZ2hib3Job29kc0hUTUwoKTtcclxuICAgIH1cclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldCBuZWlnaGJvcmhvb2RzIEhUTUwuXHJcbiAqL1xyXG5maWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZWlnaGJvcmhvb2RzLXNlbGVjdCcpO1xyXG4gIG5laWdoYm9yaG9vZHMuZm9yRWFjaChuZWlnaGJvcmhvb2QgPT4ge1xyXG4gICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbmVpZ2hib3Job29kO1xyXG4gICAgb3B0aW9uLnZhbHVlID0gbmVpZ2hib3Job29kO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBsZWFmbGV0IG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xyXG4gICAgICAgIGNlbnRlcjogWzQwLjcyMjIxNiwgLTczLjk4NzUwMV0sXHJcbiAgICAgICAgem9vbTogMTIsXHJcbiAgICAgICAgc2Nyb2xsV2hlZWxab29tOiBmYWxzZVxyXG4gICAgICB9KTtcclxuICBMLnRpbGVMYXllcignaHR0cHM6Ly9hcGkudGlsZXMubWFwYm94LmNvbS92NC97aWR9L3t6fS97eH0ve3l9LmpwZzcwP2FjY2Vzc190b2tlbj17bWFwYm94VG9rZW59Jywge1xyXG4gICAgbWFwYm94VG9rZW46ICdway5leUoxSWpvaVptRnljbVZzYkhOamNtbHdkQ0lzSW1FaU9pSmphbUppYVRsM2RITXhPR3hzTXpKd1pUbG1Zbk40WkhONUluMC42RXk1MGVsMGF0d2pEeWdPX2NPMHNBJyxcclxuICAgIG1heFpvb206IDE4LFxyXG4gICAgYXR0cmlidXRpb246ICdNYXAgZGF0YSAmY29weTsgPGEgaHJlZj1cImh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL1wiPk9wZW5TdHJlZXRNYXA8L2E+IGNvbnRyaWJ1dG9ycywgJyArXHJcbiAgICAgICc8YSBocmVmPVwiaHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LXNhLzIuMC9cIj5DQy1CWS1TQTwvYT4sICcgK1xyXG4gICAgICAnSW1hZ2VyeSDCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9cIj5NYXBib3g8L2E+JyxcclxuICAgIGlkOiAnbWFwYm94LnN0cmVldHMnXHJcbiAgfSkuYWRkVG8obmV3TWFwKTtcclxuICBcclxuICB1cGRhdGVSZXN0YXVyYW50cygpO1xyXG4gIH1cclxuICBcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xyXG4gIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xyXG4gIHNlbGYubWFya2VycyA9IFtdO1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnRzLWxpc3QnKTtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICBhZGRNYXJrZXJzVG9NYXAoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuXHJcbiAqL1xyXG5jcmVhdGVSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG5cclxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgaW1hZ2UuYWx0ID0gREJIZWxwZXIuaW1hZ2VUZXh0Rm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY1NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGxpLmFwcGVuZChpbWFnZSk7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGxpLmFwcGVuZChuYW1lKTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICBsaS5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBsaS5hcHBlbmQoYWRkcmVzcyk7XHJcblxyXG4gIGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgbW9yZS5pbm5lckhUTUwgPSBEQkhlbHBlci51cmxUZXh0Rm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGxpLmFwcGVuZChtb3JlKVxyXG5cclxuICByZXR1cm4gbGlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG5hZGRNYXJrZXJzVG9NYXAgPSAocmVzdGF1cmFudHMgPSBzZWxmLnJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgcmVzdGF1cmFudHMuZm9yRWFjaChyZXN0YXVyYW50ID0+IHtcclxuICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgY29uc3QgbWFya2VyID0gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCBzZWxmLm5ld01hcCk7XHJcbiAgICBtYXJrZXIub24oXCJjbGlja1wiLCBvbkNsaWNrKTtcclxuICAgIGZ1bmN0aW9uIG9uQ2xpY2soKSB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLm9wdGlvbnMudXJsO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIH0gXHJcbiAgLyogYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIHJlc3RhdXJhbnRzLmZvckVhY2gocmVzdGF1cmFudCA9PiB7XHJcbiAgICAvLyBBZGQgbWFya2VyIHRvIHRoZSBtYXBcclxuICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCAnY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gbWFya2VyLnVybFxyXG4gICAgfSk7XHJcbiAgICBzZWxmLm1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gIH0pO1xyXG59ICovXHJcbiJdfQ==
