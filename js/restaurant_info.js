let restaurant;var newMap;document.addEventListener("DOMContentLoaded",e=>{initMap()}),initMap=(()=>{fetchRestaurantFromURL((e,t)=>{e?console.error(e):(self.newMap=L.map("map",{center:[t.latlng.lat,t.latlng.lng],zoom:16,scrollWheelZoom:!1}),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.jpg70?access_token={mapboxToken}",{mapboxToken:"pk.eyJ1IjoiZmFycmVsbHNjcmlwdCIsImEiOiJjamJiaTl3dHMxOGxsMzJwZTlmYnN4ZHN5In0.6Ey50el0atwjDygO_cO0sA",maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets"}).addTo(newMap),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.newMap))})}),fetchRestaurantFromURL=(e=>{if(self.restaurant)return void e(null,self.restaurant);const t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,(t,n)=>{self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}),fillRestaurantHTML=((e=self.restaurant)=>{document.getElementById("restaurant-name").innerHTML=e.name,document.getElementById("restaurant-address").innerHTML=e.address;const t=document.getElementById("restaurant-img");t.className="restaurant-img",t.src=DBHelper.imageUrlForRestaurant(e),t.alt=DBHelper.imageTextForRestaurant(e),t.srcset=DBHelper.imageSrcSetForRestaurant(e),document.getElementById("restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()}),fillRestaurantHoursHTML=((e=self.restaurant.operating_hours)=>{const t=document.getElementById("restaurant-hours");for(let n in e){const a=document.createElement("tr"),r=document.createElement("td");r.innerHTML=n,a.appendChild(r);const o=document.createElement("td");o.innerHTML=e[n],a.appendChild(o),t.appendChild(a)}}),fillReviewsHTML=((e=self.restaurant.reviews)=>{const t=document.getElementById("reviews-container"),n=document.createElement("h3");if(n.innerHTML="Reviews",t.appendChild(n),!e){const e=document.createElement("p");return e.innerHTML="No reviews yet!",void t.appendChild(e)}const a=document.getElementById("reviews-list");e.forEach(e=>{a.appendChild(createReviewHTML(e))}),t.appendChild(a)}),createReviewHTML=(e=>{const t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);const a=document.createElement("p");a.innerHTML=e.date,t.appendChild(a);const r=document.createElement("p");r.innerHTML=`Rating: ${e.rating}`,t.appendChild(r);const o=document.createElement("p");return o.innerHTML=e.comments,t.appendChild(o),t}),fillBreadcrumb=((e=self.restaurant)=>{const t=document.getElementById("breadcrumb"),n=document.createElement("li");n.setAttribute("aria-current","page"),n.innerHTML=e.name,t.appendChild(n)}),getParameterByName=((e,t)=>{t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp(`[?&]${e}(=([^&#]*)|&|#|$)`).exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibmV3TWFwIiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiTCIsIm1hcCIsImNlbnRlciIsImxhdGxuZyIsImxhdCIsImxuZyIsInpvb20iLCJzY3JvbGxXaGVlbFpvb20iLCJ0aWxlTGF5ZXIiLCJtYXBib3hUb2tlbiIsIm1heFpvb20iLCJhdHRyaWJ1dGlvbiIsImZpbGxCcmVhZGNydW1iIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiY2FsbGJhY2siLCJpZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIiwibmFtZSIsImFkZHJlc3MiLCJpbWFnZSIsImNsYXNzTmFtZSIsInNyYyIsImltYWdlVXJsRm9yUmVzdGF1cmFudCIsImFsdCIsImltYWdlVGV4dEZvclJlc3RhdXJhbnQiLCJzcmNzZXQiLCJpbWFnZVNyY1NldEZvclJlc3RhdXJhbnQiLCJjdWlzaW5lX3R5cGUiLCJvcGVyYXRpbmdfaG91cnMiLCJmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCIsImZpbGxSZXZpZXdzSFRNTCIsIm9wZXJhdGluZ0hvdXJzIiwiaG91cnMiLCJrZXkiLCJyb3ciLCJjcmVhdGVFbGVtZW50IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwicmV2aWV3cyIsImNvbnRhaW5lciIsInRpdGxlIiwibm9SZXZpZXdzIiwidWwiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImxpIiwiZGF0ZSIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsInNldEF0dHJpYnV0ZSIsInVybCIsInJlcGxhY2UiLCJocmVmIiwicmVnZXgiLCJSZWdFeHAi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QU1DLEVBQVNuQyxTQUFTcUIsY0FBYyxLQUN0Q2MsRUFBT2pDLHFCQUF1QjZCLEVBQU9JLFNBQ3JDRixFQUFHVixZQUFZWSxHQUVmLE1BQU1DLEVBQVdwQyxTQUFTcUIsY0FBYyxLQUl4QyxPQUhBZSxFQUFTbEMsVUFBWTZCLEVBQU9LLFNBQzVCSCxFQUFHVixZQUFZYSxHQUVSSCxJQU1UekMsZUFBaUIsRUFBQ25CLEVBQUFBLEtBQVdNLGNBQzNCLE1BQU0wRCxFQUFhckMsU0FBU0MsZUFBZSxjQUNyQ2dDLEVBQUtqQyxTQUFTcUIsY0FBYyxNQUNsQ1ksRUFBR0ssYUFBYSxlQUFoQixRQUNBTCxFQUFHL0IsVUFBWTdCLEVBQVc4QixLQUMxQmtDLEVBQVdkLFlBQVlVLEtBTXpCcEMsbUJBQXFCLEVBQUNNLEVBQU1vQyxLQUNyQkEsSUFFTHBDLEVBQU9BLE9BQUtxQyxTQUFRQyxNQUNwQnRDLEVBQU11QyxFQUFBQSxRQUFZQyxVQUFRLFFBQTFCLE1BRUFDLEVBREVBLElBQVVGLGNBRFp2QyxzQkFHRTBDLEtBQU9OLEdBQ1QsT0FBS0ssRUFSUEEsRUFBQSxHQVVTRSxtQkFBbUJGLEVBQVEsR0FBR0osUUFBUSxNQUFPLE1BRDNDLEdBQ0ZNIiwiZmlsZSI6InJlc3RhdXJhbnRfaW5mby5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCByZXN0YXVyYW50O1xudmFyIG5ld01hcDtcblxuLy8gLyoqXG4vLyAgKiBDaGVjayB0byBzZWUgaWYgc2VydmljZSB3b3JrZXIgaXMgc3VwcG9ydGVkIGJ5IHRoZSBicm93c2VyIFxuLy8gICovXG4vLyBpZiAoJ3NlcnZpY2VXb3JrZXInIGluIG5hdmlnYXRvcikge1xuICBcbi8vICAgLyogaWYgaXQgaXMsIHJlZ2lzdGVyIHRoZSBzZXJ2aWNlIHdvcmtlciAqL1xuLy8gICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3N3LmpzJykudGhlbihmdW5jdGlvbihyZXMpe1xuXG4vLyAgICAgLy8gQWxyZWFkeSBvbiB0aGUgbGF0ZXN0IHZlcnNpb24sIGJhaWxcbi8vICAgICBpZighbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIuY29udHJvbGxlcil7XG4vLyAgICAgICByZXR1cm47XG4vLyAgICAgfVxuLy8gICAgIC8vIENoZWNrIHRvIHNlZSBpZiB0aGVyZSdzIGEgd2FpdGluZyBzZXJ2aWNlIHdvcmtlclxuLy8gICAgIGlmIChyZXMud2FpdGluZyl7XG4vLyAgICAgICBfdXBkYXRlUmVhZHkoKTtcbi8vICAgICAgIHJldHVybiBcbi8vICAgICB9XG5cbi8vICAgICBpZiAocmVzLmluc3RhbGxpbmcpIHtcbi8vICAgICAgIF90cmFja0luc3RhbGxpbmcocmVzLmluc3RhbGxpbmcpO1xuLy8gICAgICAgcmV0dXJuO1xuLy8gICAgIH1cbiAgICBcbi8vICAgICByZXMuYWRkRXZlbnRMaXN0ZW5lcigndXBkYXRlZm91bmQnLCBmdW5jdGlvbigpIHtcbi8vICAgICAgIF90cmFja0luc3RhbGxpbmcocmVzLmluc3RhbGxpbmcpO1xuLy8gICAgIH0pO1xuICAgIFxuLy8gICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcil7XG4vLyAgICAgY29uc29sZS5sb2coJ2Vycm9yIHJlZ2lzdGVyaW5nIHNlcnZpY2Ugd29ya2VyOiAnLGVycm9yKVxuLy8gICB9KTtcbiAgXG4vLyAgIGZ1bmN0aW9uIF90cmFja0luc3RhbGxpbmcod29ya2VyKXtcbi8vICAgICB3b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignc3RhdGVjaGFuZ2UnLGZ1bmN0aW9uKCl7XG4vLyAgICAgICBpZiAod29ya2VyLnN0YXRlID09ICdpbnN0YWxsZWQnKXtcbi8vICAgICAgICAgX3VwZGF0ZVJlYWR5KHdvcmtlcik7XG4vLyAgICAgICB9XG4vLyAgICAgfSlcbi8vICAgfVxuXG4vLyAgIHZhciBmb2N1c2VkRWxlbWVudDtcbi8vICAgLyoqXG4vLyAgICAqIE5vdGlmaWVzIHRoZSB1c2VyIHRoYXQgYW4gdXBkYXRlZCBTVyBpcyBhdmFpbGFibGVcbi8vICAgICovXG4vLyAgIGZ1bmN0aW9uIF91cGRhdGVSZWFkeSh3b3JrZXIpe1xuLy8gICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyBvbiB0aGUgdXBkYXRlIGJ1dHRvbiwgdXBkYXRlIHRoZSBzZXJ2aWNlIHdvcmtlclxuLy8gICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGRhdGUtdmVyc2lvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpe1xuLy8gICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHthY3Rpb246J3NraXBXYWl0aW5nJ30pO1xuLy8gICAgIH0pO1xuLy8gICAgIC8vIElmIHRoZSB1c2VyIGNsaWNrcyB0aGUgZGlzbWlzcyBidXR0b24sIGhpZGUgdGhlIHRvYXN0XG4vLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rpc21pc3MtdmVyc2lvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyxmdW5jdGlvbigpe1xuLy8gICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4vLyAgICAgICBmb2N1c2VkRWxlbWVudC5mb2N1cygpXG4vLyAgICAgfSk7XG4vLyAgICAgLy8gSWYgdGhlIHRvYXN0IGlzIGRpc3BsYXlpbmcsIGxpc3RlbiBmb3Iga2V5Ym9hcmQgZXZlbnRzXG4vLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsZnVuY3Rpb24oZSl7XG4vLyAgICAgICAvL0NoZWNrIGZvciBUYWIga2V5IHByZXNzXG4vLyAgICAgICBpZihlLmtleUNvZGUgPT09IDkpe1xuICAgICAgICBcbi8vICAgICAgICAgaWYgKGUuc2hpZnRLZXkpIHtcbi8vICAgICAgICAgICAvL1ByZXNzZWQgU2hpZnQgVGFiXG4vLyAgICAgICAgICAgaWYoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gZmlyc3RUYWJTdG9wKSB7XG4vLyAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgICAgICAgICBsYXN0VGFiU3RvcC5mb2N1cygpO1xuLy8gICAgICAgICAgIH1cbi8vICAgICAgICAgfWVsc2V7XG4vLyAgICAgICAgICAgLy9QcmVzc2VkIFRhYlxuLy8gICAgICAgICAgIGlmKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IGxhc3RUYWJTdG9wKSB7XG4vLyAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4vLyAgICAgICAgICAgICBmaXJzdFRhYlN0b3AuZm9jdXMoKTtcbi8vICAgICAgICAgICB9XG4vLyAgICAgICAgIH1cbi8vICAgICAgIH1cbi8vICAgICAgIC8vIEVzY2FwZSBLZXlcbi8vICAgICAgIGlmIChlLmtleUNvZGUgPT09IDI3KXtcbi8vICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG4vLyAgICAgICAgIGZvY3VzZWRFbGVtZW50LmZvY3VzKClcbi8vICAgICAgIH0gXG4vLyAgICAgfSk7XG5cbi8vICAgICAvLyBSZW1lbWJlciB3aGF0IHRoZSBsYXN0IGVsZW1lbnQgdGhhdCB3YXMgZm9jdXNlZCB3YXMsIGFuZCBtYWtlIGl0IGZvY3VzYWJsZSBzbyB3ZSBjYW4gcmV0dXJuIHRvIGl0XG4vLyAgICAgZm9jdXNlZEVsZW1lbnQgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuLy8gICAgIGZvY3VzZWRFbGVtZW50LnRhYmluZGV4ID0gMTtcbiAgIFxuLy8gICAgIC8vIFdoZW4gdGhlIHRvYXN0IGlzIHZpc2libGUsIHRoaXMgaXMgd2hhdCB3ZSdsbCB1c2UgdG8gdGVtcG9yYXJpbHkgdHJhcCBmb2N1c1xuLy8gICAgIHZhciBmb2N1c2FibGVFbGVtZW50c1N0cmluZyA9ICcjdG9hc3QgcCwgI3VwZGF0ZS12ZXJzaW9uLCAjZGlzbWlzcy12ZXJzaW9uJztcbi8vICAgICB2YXIgZm9jdXNhYmxlRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGZvY3VzYWJsZUVsZW1lbnRzU3RyaW5nKTtcbi8vICAgICBmb2N1c2FibGVFbGVtZW50cyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGZvY3VzYWJsZUVsZW1lbnRzKTtcbiAgICBcbi8vICAgICB2YXIgZmlyc3RUYWJTdG9wID0gZm9jdXNhYmxlRWxlbWVudHNbMF07XG4vLyAgICAgdmFyIGxhc3RUYWJTdG9wID0gZm9jdXNhYmxlRWxlbWVudHNbZm9jdXNhYmxlRWxlbWVudHMubGVuZ3RoIC0xXTtcblxuLy8gICAgIC8vIE9rIHRpbWUgdG8gc2hvdyB0aGUgdG9hc3QgYW5kIGZvY3VzIG9uIGl0XG4vLyAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0JykuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4vLyAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3RvYXN0IHAnKS5mb2N1cygpO1xuXG4vLyAgIH1cbiAgXG5cbi8vICAgLyoqXG4vLyAgICAqIExpc3RlbnMgZm9yIGEgY2hhbmdlIGluIHRoZSBTVywgcmVsb2FkcyB0aGUgcGFnZSBhcyBhIHJlc3VsdFxuLy8gICAgKi9cbi8vICAgdmFyIHJlZnJlc2hpbmc7XG4vLyAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRyb2xsZXJjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbi8vICAgICBjb25zb2xlLmxvZygnY29udHJvbGxlciBjaGFuZ2UnKVxuLy8gICAgIGlmIChyZWZyZXNoaW5nKSByZXR1cm47XG4vLyAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuLy8gICAgIHJlZnJlc2hpbmcgPSB0cnVlO1xuLy8gICB9KTtcbi8vIH1cblxuXG5cbi8qKlxuICAqIEluaXRpYWxpemUgbWFwIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxuICovXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7ICBcbiAgaW5pdE1hcCgpO1xuICB9KTtcbiAgXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGxlYWZsZXQgbWFwXG4gICAqL1xuICBpbml0TWFwID0gKCkgPT4ge1xuICBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMKChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9IGVsc2UgeyAgICAgIFxuICAgICAgc2VsZi5uZXdNYXAgPSBMLm1hcCgnbWFwJywge1xuICAgICAgICBjZW50ZXI6IFtyZXN0YXVyYW50LmxhdGxuZy5sYXQsIHJlc3RhdXJhbnQubGF0bG5nLmxuZ10sXG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBzY3JvbGxXaGVlbFpvb206IGZhbHNlXG4gICAgICB9KTtcbiAgICAgIEwudGlsZUxheWVyKCdodHRwczovL2FwaS50aWxlcy5tYXBib3guY29tL3Y0L3tpZH0ve3p9L3t4fS97eX0uanBnNzA/YWNjZXNzX3Rva2VuPXttYXBib3hUb2tlbn0nLCB7XG4gICAgICAgIG1hcGJveFRva2VuOiAncGsuZXlKMUlqb2labUZ5Y21Wc2JITmpjbWx3ZENJc0ltRWlPaUpqYW1KaWFUbDNkSE14T0d4c016SndaVGxtWW5ONFpITjVJbjAuNkV5NTBlbDBhdHdqRHlnT19jTzBzQScsXG4gICAgICAgIG1heFpvb206IDE4LFxuICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCBkYXRhICZjb3B5OyA8YSBocmVmPVwiaHR0cHM6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvXCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzLCAnICtcbiAgICAgICAgICAnPGEgaHJlZj1cImh0dHBzOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8yLjAvXCI+Q0MtQlktU0E8L2E+LCAnICtcbiAgICAgICAgICAnSW1hZ2VyeSDCqSA8YSBocmVmPVwiaHR0cHM6Ly93d3cubWFwYm94LmNvbS9cIj5NYXBib3g8L2E+JyxcbiAgICAgICAgaWQ6ICdtYXBib3guc3RyZWV0cycgICAgXG4gICAgICB9KS5hZGRUbyhuZXdNYXApO1xuICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBzZWxmLm5ld01hcCk7XG4gICAgfVxuICB9KTtcbiAgfSAgXG4gIFxuICAvKiB3aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgfSAqL1xuXG4vKipcbiAqIEdldCBjdXJyZW50IHJlc3RhdXJhbnQgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCA9IChjYWxsYmFjaykgPT4ge1xuICBpZiAoc2VsZi5yZXN0YXVyYW50KSB7IC8vIHJlc3RhdXJhbnQgYWxyZWFkeSBmZXRjaGVkIVxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XG4gIGlmICghaWQpIHsgLy8gbm8gaWQgZm91bmQgaW4gVVJMXG4gICAgZXJyb3IgPSAnTm8gcmVzdGF1cmFudCBpZCBpbiBVUkwnXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xuICB9IGVsc2Uge1xuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5SWQoaWQsIChlcnJvciwgcmVzdGF1cmFudCkgPT4ge1xuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcbiAgICAgIGlmICghcmVzdGF1cmFudCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZmlsbFJlc3RhdXJhbnRIVE1MKCk7XG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXG4gKi9cbmZpbGxSZXN0YXVyYW50SFRNTCA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1hZGRyZXNzJyk7XG4gIGFkZHJlc3MuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5hZGRyZXNzO1xuXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtaW1nJyk7XG4gIGltYWdlLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZydcbiAgaW1hZ2Uuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICBpbWFnZS5hbHQgPSBEQkhlbHBlci5pbWFnZVRleHRGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xuICBpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY1NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xuXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcblxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodGl0bGUpO1xuXG4gIGlmICghcmV2aWV3cykge1xuICAgIGNvbnN0IG5vUmV2aWV3cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKG5vUmV2aWV3cyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtbGlzdCcpO1xuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuICB9KTtcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKHVsKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuY3JlYXRlUmV2aWV3SFRNTCA9IChyZXZpZXcpID0+IHtcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBkYXRlLmlubmVySFRNTCA9IHJldmlldy5kYXRlO1xuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcblxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcbiAgbGkuYXBwZW5kQ2hpbGQocmF0aW5nKTtcblxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgY29tbWVudHMuaW5uZXJIVE1MID0gcmV2aWV3LmNvbW1lbnRzO1xuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XG5cbiAgcmV0dXJuIGxpO1xufVxuXG4vKipcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XG4gKi9cbmZpbGxCcmVhZGNydW1iID0gKHJlc3RhdXJhbnQ9c2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGxpLnNldEF0dHJpYnV0ZSgnYXJpYS1jdXJyZW50JywncGFnZScpXG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuICBpZiAoIXVybClcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gJyc7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59XG4iXX0=
